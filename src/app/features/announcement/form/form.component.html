<div class="container">
  <h2>{{ isEditMode ? 'Edit Announcement' : 'Add Announcement' }}</h2>
  <form #f="ngForm">

    <div class="form-group">
      <label>Title</label>
      <input type="text" name="title" [(ngModel)]="announcement.title"
             #t="ngModel" class="form-control" minlength="3" maxlength="15" required>
    </div>
    <div class="alert alert-danger" *ngIf="t.invalid && t.touched">
      <div *ngIf="t.hasError('required')">this field is required</div>
      <div *ngIf="t.hasError('minlength') || t.hasError('maxlength')">title must be 3 to 15 characters long</div>
    </div>
    
    <div class="form-group">
      <label>Address</label>
      <input type="text" name="address" [(ngModel)]="announcement.address" 
             #address="ngModel" class="form-control"  minlength="10" maxlength="20"  required>
    </div>
    <div class="alert alert-danger" *ngIf="address.invalid && address.touched">
      <div *ngIf="address.hasError('required')">This field is required</div>
      <div *ngIf="address.hasError('minlength')|| address.hasError('maxlength')">address must be 10 to 15 characters long</div>
    </div>

 
    <div class="form-group">
      <label for="category">Category</label>
      <select 
        name="category" [(ngModel)]="announcement.category" 
        #category="ngModel" class="form-control" required>
        <option value="" disabled selected>Select a category</option>
        <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
      </select>
      <div *ngIf="category.invalid && category.touched" class="alert alert-danger">
        Category is required.
      </div>
    </div>   
    <div class="alert alert-danger" *ngIf="category.invalid && category.touched">
        <div *ngIf="category.hasError('required')">This field is required</div>
        <div *ngIf="category.hasError('minlength')|| category.hasError('maxlength')">category must be 3 to 10 characters long</div>
    </div>

    <div class="form-group">
      <label>Price</label>
      <input type="number" name="price" [(ngModel)]="announcement.price" 
             #price="ngModel" class="form-control" min="1000" max="999999999" required>
    </div>         
    <div class="alert alert-danger" *ngIf="price.invalid && price.touched">
        <div *ngIf="price.hasError('required')">This field is required</div>
        <div *ngIf="price.hasError('min')||price.hasError('max')">price range : 1000-999999999</div>
    </div>

    <div class="form-group">
      <label>Description</label>
      <textarea name="description" [(ngModel)]="announcement.description" 
                #description="ngModel" class="form-control" maxlength="100"></textarea>
    </div>
    <div class="alert alert-danger" *ngIf="description.invalid && description.touched">
      <div *ngIf="description.hasError('maxlength')">Max length is 100 characters</div>
    </div>
    
    <div class="form-group">
      <label>Surface (mÂ²)</label>
      <input type="number" name="surface" [(ngModel)]="announcement.surface" 
             #surface="ngModel" class="form-control" min="100" max="99999" required>
    </div>
    <div class="alert alert-danger" *ngIf="surface.invalid && surface.touched">
      <div *ngIf="surface.hasError('required')">This field is required</div>
      <div *ngIf="surface.hasError('min') || surface.hasError('max')">Surface must be 100-99999</div>
    </div>
    
    <div class="form-group">
      <label>Status</label>
      <input type="text" name="status" [(ngModel)]="announcement.status" 
             #status="ngModel" class="form-control" minlength="3" maxlength="10" required>
    </div>
    <div class="alert alert-danger" *ngIf="status.invalid && status.touched">
      <div *ngIf="status.hasError('required')">This field is required</div>
      <div *ngIf="status.hasError('minlength')||status.hasError('maxlength')">status must be 3-10 characters long</div>
    </div>
    
    <div class="form-group">
      <label>Number of Rooms</label>
      <input type="number" name="roomsNumber" [(ngModel)]="announcement.roomsNumber" 
             #roomsNumber="ngModel" class="form-control" min="1" required>
    </div>
    <div class="alert alert-danger" *ngIf="roomsNumber.invalid && roomsNumber.touched">
      <div *ngIf="roomsNumber.hasError('required')">This field is required</div>
      <div *ngIf="roomsNumber.hasError('min')">Number of rooms must be at least 1</div>
    </div>
    
    <div class="form-group">
      <label for="image">Upload Picture</label>
      <input type="file" id="image" name="image" (change)="onImageSelect($event)" accept="image/*" class="form-control">
    </div>
    
    <div *ngIf="imagePreview">
      <label>Image Preview</label>
      <img [src]="imagePreview" alt="Image preview" class="img-fluid image-preview" />
    </div>
    
    

    <button 
    class="btn btn-success" 
    (click)="save()" 
    [disabled]="f.invalid">
    {{ isEditMode ? 'Update' : 'Save' }}
  </button>
  <button type="submit"></button>
  &nbsp;
  
    <button type="reset" class="btn btn-warning">reset</button>
  </form>
</div>

<style>
  .image-preview {
    max-width: 1000px;
    max-height: 900px;
    object-fit: cover; /* Ensures the image covers the area without distortion */
  }
</style>